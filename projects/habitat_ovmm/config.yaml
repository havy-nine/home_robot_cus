{'habitat': {'seed': 7, 'env_task': 'GymHabitatEnv', 'env_task_gym_dependencies': [], 'env_task_gym_id': '', 'environment': {'max_episode_steps': 1250, 'max_episode_seconds': 10000000, 'iterator_options': {'cycle': True, 'shuffle': True, 'group_by_scene': True, 'num_episode_sample': -1, 'max_scene_repeat_episodes': -1, 'max_scene_repeat_steps': 10000, 'step_repetition_range': 0.2}}, 'simulator': {'type': 'OVMMSim-v0', 'forward_step_size': 0.25, 'turn_angle': 30, 'create_renderer': False, 'requires_textures': True, 'auto_sleep': True, 'sleep_dist': 3.0, 'step_physics': True, 'concur_render': True, 'needs_markers': False, 'update_articulated_agent': True, 'scene': 'data/scene_datasets/habitat-test-scenes/van-gogh-room.glb', 'scene_dataset': 'default', 'additional_object_paths': ['data/objects/train_val/amazon_berkeley/configs/', 'data/objects/train_val/google_scanned/configs/', 'data/objects/train_val/ai2thorhab/configs/objects/', 'data/objects/train_val/hssd/configs/objects/'], 'seed': '${habitat.seed}', 'default_agent_id': 0, 'debug_render': False, 'debug_render_articulated_agent': False, 'kinematic_mode': True, 'simulate_fall': True, 'should_setup_semantic_ids': True, 'debug_render_goal': False, 'robot_joint_start_noise': 0.0, 'ctrl_freq': 120.0, 'ac_freq_ratio': 4, 'load_objs': True, 'hold_thresh': 0.15, 'grasp_impulse': 10000.0, 'agents': {'main_agent': {'height': 1.41, 'radius': 0.3, 'grasp_managers': 1, 'sim_sensors': {'head_rgb_sensor': {'type': 'HabitatSimRGBSensor', 'height': 640, 'width': 480, 'position': [0.0, 1.25, 0.0], 'orientation': [0.0, 0.0, 0.0], 'hfov': 42, 'sensor_subtype': 'PINHOLE', 'noise_model': 'None', 'noise_model_kwargs': {}, 'uuid': 'head_rgb'}, 'head_depth_sensor': {'type': 'HabitatSimDepthSensor', 'height': 640, 'width': 480, 'position': [0.0, 1.25, 0.0], 'orientation': [0.0, 0.0, 0.0], 'hfov': 42, 'sensor_subtype': 'PINHOLE', 'noise_model': 'None', 'noise_model_kwargs': {}, 'min_depth': 0.0, 'max_depth': 10.0, 'normalize_depth': True, 'uuid': 'head_depth'}, 'head_panoptic_sensor': {'type': 'HabitatSimSemanticSensor', 'height': 640, 'width': 480, 'position': [0.0, 1.25, 0.0], 'orientation': [0.0, 0.0, 0.0], 'hfov': 42, 'sensor_subtype': 'PINHOLE', 'noise_model': 'None', 'noise_model_kwargs': {}, 'uuid': 'head_panoptic'}, 'third_rgb_sensor': {'type': 'HabitatSimRGBSensor', 'height': 512, 'width': 512, 'position': [0.0, 1.25, 0.0], 'orientation': [0.0, 0.0, 0.0], 'hfov': 90, 'sensor_subtype': 'PINHOLE', 'noise_model': 'None', 'noise_model_kwargs': {}, 'uuid': 'third_rgb'}}, 'is_set_start_state': False, 'start_position': [0.0, 0.0, 0.0], 'start_rotation': [0.0, 0.0, 0.0, 1.0], 'joint_start_noise': 0.1, 'joint_start_override': None, 'articulated_agent_urdf': 'data/robots/hab_stretch/urdf/hab_stretch.urdf', 'articulated_agent_type': 'StretchRobot', 'ik_arm_urdf': None, 'motion_data_path': ''}}, 'agents_order': ['main_agent'], 'default_agent_navmesh': True, 'navmesh_include_static_objects': False, 'habitat_sim_v0': {'gpu_device_id': 0, 'gpu_gpu': False, 'allow_sliding': False, 'frustum_culling': True, 'enable_physics': True, 'physics_config_file': './data/default.physics_config.json', 'leave_context_with_background_renderer': False, 'enable_gfx_replay_save': False, 'pbr_image_based_lighting': True}, 'ep_info': None, 'object_ids_start': 100, 'renderer': {'enable_batch_renderer': False, 'composite_files': None, 'classic_replay_renderer': False}}, 'task': {'physics_target_sps': 60.0, 'reward_measure': 'ovmm_place_success', 'success_measure': 'ovmm_place_success', 'success_reward': 10.0, 'slack_reward': -0.005, 'end_on_success': True, 'type': 'OVMMNavToObjTask-v0', 'lab_sensors': {'joint_sensor': {'type': 'JointSensor', 'dimensionality': 10}, 'joint_velocity_sensor': {'type': 'JointVelocitySensor', 'dimensionality': 10}, 'object_category_sensor': {'type': 'ObjectCategorySensor'}, 'start_receptacle_sensor': {'type': 'StartReceptacleSensor'}, 'goal_receptacle_sensor': {'type': 'GoalReceptacleSensor'}, 'object_segmentation_sensor': {'type': 'ObjectSegmentationSensor', 'blank_out_prob': 0.0}, 'object_embedding_sensor': {'type': 'ObjectEmbeddingSensor', 'embeddings_file': 'data/objects/clip_embeddings.pickle', 'dimensionality': 512}, 'start_recep_segmentation_sensor': {'type': 'StartRecepSegmentationSensor', 'blank_out_prob': 0.0}, 'goal_recep_segmentation_sensor': {'type': 'GoalRecepSegmentationSensor', 'blank_out_prob': 0.0}, 'robot_start_gps_sensor': {'type': 'RobotStartGPSSensor', 'dimensionality': 2}, 'robot_start_compass_sensor': {'type': 'RobotStartCompassSensor'}, 'camera_pose_sensor': {'type': 'CameraPoseSensor'}, 'end_effector_sensor': {'type': 'EEPositionSensor'}, 'relative_resting_pos_sensor': {'type': 'RelativeRestingPositionSensor'}, 'is_holding_sensor': {'type': 'IsHoldingSensor'}, 'ovmm_nav_goal_segmentation_sensor': {'type': 'OVMMNavGoalSegmentationSensor', 'blank_out_prob': 0.0}, 'receptacle_segmentation_sensor': {'type': 'ReceptacleSegmentationSensor', 'blank_out_prob': 0.0}}, 'measurements': {'ovmm_object_to_place_goal_distance': {'type': 'OVMMObjectToPlaceGoalDistance'}, 'articulated_agent_force': {'type': 'RobotForce', 'min_force': 20.0}, 'force_terminate': {'type': 'ForceTerminate', 'max_accum_force': -1.0, 'max_instant_force': -1.0}, 'articulated_agent_colls': {'type': 'RobotCollisions'}, 'does_want_terminate': {'type': 'DoesWantTerminate'}, 'num_steps': {'type': 'NumStepsMeasure'}, 'obj_anywhere_on_goal': {'type': 'ObjAnywhereOnGoal'}, 'end_effector_to_rest_distance': {'type': 'EndEffectorToRestDistance'}, 'did_pick_object': {'type': 'DidPickObjectMeasure'}, 'pick_success': {'type': 'RearrangePickSuccess', 'ee_resting_success_threshold': 100.0, 'object_goal': True}, 'picked_object_linear_vel': {'type': 'PickedObjectLinearVel'}, 'picked_object_angular_vel': {'type': 'PickedObjectAngularVel'}, 'object_at_rest': {'type': 'ObjectAtRest', 'angular_vel_thresh': 0.05, 'linear_vel_thresh': 0.005}, 'ovmm_placement_stability': {'type': 'OVMMPlacementStability', 'stability_steps': 50.0}, 'ovmm_place_success': {'type': 'OVMMPlaceSuccess', 'ee_resting_success_threshold': 100.0, 'check_stability': True}, 'dist_to_pick_goal': {'type': 'OVMMDistToPickGoal', 'use_shortest_path_cache': False}, 'rot_dist_to_pick_goal': {'type': 'OVMMRotDistToPickGoal'}, 'pick_goal_iou_coverage': {'type': 'PickGoalIoUCoverage', 'max_goal_dist': 0.1}, 'nav_to_pick_succ': {'type': 'OVMMNavToPickSucc', 'success_distance': 0.1}, 'nav_orient_to_pick_succ': {'type': 'OVMMNavOrientToPickSucc', 'must_look_at_targ': True, 'must_call_stop': False, 'success_angle_dist': 3.14, 'min_object_coverage_iou': 0.001}, 'dist_to_place_goal': {'type': 'OVMMDistToPlaceGoal', 'use_shortest_path_cache': False}, 'rot_dist_to_place_goal': {'type': 'OVMMRotDistToPlaceGoal'}, 'place_goal_iou_coverage': {'type': 'PlaceGoalIoUCoverage', 'max_goal_dist': 0.1}, 'nav_to_place_succ': {'type': 'OVMMNavToPlaceSucc', 'success_distance': 0.1}, 'nav_orient_to_place_succ': {'type': 'OVMMNavOrientToPlaceSucc', 'must_look_at_targ': True, 'must_call_stop': False, 'success_angle_dist': 3.14, 'min_object_coverage_iou': 0.001}, 'ovmm_find_object_phase_success': {'type': 'OVMMFindObjectPhaseSuccess'}, 'ovmm_pick_object_phase_success': {'type': 'OVMMPickObjectPhaseSuccess'}, 'ovmm_find_recep_phase_success': {'type': 'OVMMFindRecepPhaseSuccess'}, 'ovmm_place_object_phase_success': {'type': 'OVMMPlaceObjectPhaseSuccess'}, 'navmesh_collision': {'type': 'NavmeshCollision'}}, 'rank0_env0_measure_names': ['habitat_perf'], 'rank0_measure_names': [], 'goal_sensor_uuid': 'pointgoal', 'count_obj_collisions': True, 'settle_steps': 5, 'constraint_violation_ends_episode': False, 'constraint_violation_drops_object': True, 'force_regenerate': False, 'should_save_to_cache': False, 'object_in_hand_sample_prob': 0.0, 'min_start_distance': 3.0, 'render_target': True, 'physics_stability_steps': 1, 'num_spawn_attempts': 200, 'spawn_max_dist_to_obj': 2.0, 'base_angle_noise': 0.2618, 'recep_place_shrink_factor': 0.8, 'spawn_reference': 'target', 'spawn_reference_sampling': 'uniform', 'ee_sample_factor': 0.2, 'ee_exclude_region': 0.0, 'base_noise': 0.05, 'spawn_region_scale': 0.2, 'joint_max_impulse': -1.0, 'desired_resting_position': [0.5, 0.0, 1.0], 'use_marker_t': True, 'cache_robot_init': False, 'success_state': 0.0, 'should_enforce_target_within_reach': False, 'task_spec_base_path': 'habitat/task/rearrange/pddl/', 'task_spec': '', 'pddl_domain_def': 'replica_cad', 'obj_succ_thresh': 0.3, 'enable_safe_drop': False, 'art_succ_thresh': 0.15, 'robot_at_thresh': 2.0, 'actions': {'rearrange_stop': {'type': 'RearrangeStopAction', 'agent_index': 0}, 'base_velocity': {'type': 'BaseWaypointTeleportAction', 'agent_index': 0, 'lin_speed': 10.0, 'ang_speed': 10.0, 'allow_dyn_slide': True, 'allow_back': True, 'collision_threshold': 1e-05, 'navmesh_offset': [[0.0, 0.0]], 'min_displacement': 0.1, 'max_displacement_along_axis': 1.0, 'max_turn_degrees': 180.0, 'min_turn_degrees': 5.0, 'allow_lateral_movement': True, 'allow_simultaneous_turn': True, 'discrete_movement': False, 'constraint_base_in_manip_mode': False}, 'arm_action': {'type': 'ArmAction', 'agent_index': 0, 'arm_controller': 'ArmRelPosKinematicReducedActionStretch', 'grip_controller': 'GazeGraspAction', 'arm_joint_mask': [1, 0, 0, 0, 1, 1, 1, 1, 1, 1], 'arm_joint_dimensionality': 7, 'grasp_thresh_dist': 0.8, 'disable_grip': False, 'max_delta_pos': 6.28, 'min_delta_pos': 0.0, 'ee_ctrl_lim': 0.015, 'should_clip': False, 'render_ee_target': False, 'gaze_distance_range': [0.1, 3.0], 'center_cone_angle_threshold': 90.0, 'center_cone_vector': [0.0, 1.0, 0.0], 'wrong_grasp_should_end': False, 'gaze_distance_from': 'camera', 'gaze_center_square_width': 1.0, 'grasp_threshold': 0.0, 'oracle_snap': True, 'gaze_use_xy_distance': True, 'gaze_distance_to_bbox': False}}, 'start_in_manip_mode': False, 'pick_init': False, 'place_init': False, 'camera_tilt': -0.5236, 'receptacle_categories_file': 'data/objects/hssd-receptacles.csv'}, 'dataset': {'type': 'OVMMDataset-v0', 'split': 'val', 'scenes_dir': 'data/hssd-hab/', 'content_scenes': ['*'], 'data_path': 'data/datasets/ovmm/{split}/episodes.json.gz', 'viewpoints_matrix_path': 'data/datasets/ovmm/{split}/viewpoints.npy', 'transformations_matrix_path': 'data/datasets/ovmm/{split}/transformations.npy', 'episode_indices_range': None, 'episode_ids': [151, 182]}, 'gym': {'obs_keys': ['head_depth', 'head_rgb', 'third_rgb', 'start_receptacle', 'goal_receptacle', 'robot_start_gps', 'robot_start_compass', 'joint', 'object_segmentation', 'start_recep_segmentation', 'goal_recep_segmentation', 'object_category', 'camera_pose', 'object_embedding', 'is_holding', 'relative_resting_position', 'ovmm_nav_goal_segmentation', 'receptacle_segmentation'], 'action_keys': None, 'achieved_goal_keys': [], 'desired_goal_keys': []}}, 'habitat_baselines': {'evaluate': False, 'trainer_name': 'ppo', 'updater_name': 'PPO', 'distrib_updater_name': 'DDPPO', 'torch_gpu_id': 0, 'tensorboard_dir': 'tb', 'writer_type': 'tb', 'video_dir': 'video_dir', 'video_fps': 15, 'test_episode_count': -1, 'eval_ckpt_path_dir': 'data/new_checkpoints', 'num_environments': 1, 'num_processes': -1, 'rollout_storage_name': 'RolloutStorage', 'checkpoint_folder': 'data/new_checkpoints', 'num_updates': 10000, 'num_checkpoints': 20, 'checkpoint_interval': -1, 'total_num_steps': -1.0, 'log_interval': 10, 'log_file': 'train.log', 'force_blind_policy': False, 'verbose': False, 'vector_env_factory': {'_target_': 'habitat_baselines.common.HabitatVectorEnvFactory'}, 'eval_keys_to_include_in_name': ['reward', 'force', 'success'], 'force_torch_single_threaded': True, 'wb': {'project_name': '', 'entity': '', 'group': '', 'run_name': ''}, 'load_resume_state_config': True, 'eval': {'split': 'val', 'use_ckpt_config': True, 'should_load_ckpt': True, 'evals_per_ep': 1, 'video_option': ['disk'], 'extra_sim_sensors': {}}, 'profiling': {'capture_start_step': -1, 'num_steps_to_capture': -1}, 'should_log_single_proc_infos': False, 'on_save_ckpt_callback': None, 'rl': {'agent': {'type': 'SingleAgentAccessMgr'}, 'preemption': {'append_slurm_job_id': False, 'save_resume_state_interval': 100, 'save_state_batch_only': False}, 'policy': {'name': 'PointNavResNetPolicy', 'action_distribution_type': 'categorical', 'action_dist': {'use_log_std': True, 'use_softplus': False, 'std_init': '???', 'log_std_init': 0.0, 'use_std_param': False, 'clamp_std': True, 'min_std': 1e-06, 'max_std': 1, 'min_log_std': -5, 'max_log_std': 2, 'action_activation': 'tanh', 'scheduled_std': False}, 'obs_transforms': {}, 'hierarchical_policy': '???', 'ovrl': False, 'no_downscaling': False, 'use_augmentations': False, 'deterministic_actions': False}, 'ppo': {'clip_param': 0.2, 'ppo_epoch': 4, 'num_mini_batch': 2, 'value_loss_coef': 0.5, 'entropy_coef': 0.01, 'lr': 0.00025, 'eps': 1e-05, 'max_grad_norm': 0.5, 'num_steps': 5, 'use_gae': True, 'use_linear_lr_decay': False, 'use_linear_clip_decay': False, 'gamma': 0.99, 'tau': 0.95, 'reward_window_size': 50, 'use_normalized_advantage': False, 'hidden_size': 512, 'entropy_target_factor': 0.0, 'use_adaptive_entropy_pen': False, 'use_clipped_value_loss': True, 'use_double_buffered_sampler': False}, 'ddppo': {'sync_frac': 0.6, 'distrib_backend': 'GLOO', 'rnn_type': 'GRU', 'num_recurrent_layers': 1, 'backbone': 'resnet18', 'pretrained_weights': 'data/ddppo-models/gibson-2plus-resnet50.pth', 'pretrained': False, 'pretrained_encoder': False, 'train_encoder': True, 'reset_critic': True, 'force_distributed': False, 'normalize_visual_inputs': False}, 'ver': {'variable_experience': True, 'num_inference_workers': 2, 'overlap_rollouts_and_learn': False}, 'auxiliary_losses': {}}}, 'gpu_device_id': 0, 'NO_GPU': 0, 'NUM_ENVIRONMENTS': 1, 'DUMP_LOCATION': 'datadump_sam', 'EXP_NAME': 'eval_hssd_sam', 'VISUALIZE': 1, 'PRINT_IMAGES': 1, 'GROUND_TRUTH_SEMANTICS': 0, 'seed': 0, 'SHOW_RL_OBS': False, 'ENVIRONMENT': {'forward': 0.25, 'turn_angle': 30.0, 'frame_height': 640, 'frame_width': 480, 'camera_height': 1.31, 'hfov': 42.0, 'min_depth': 0.0, 'max_depth': 10.0, 'num_receptacles': 21, 'category_map_file': 'projects/real_world_ovmm/configs/example_cat_map.json', 'use_detic_viz': False, 'evaluate_instance_tracking': False, 'use_opencv_camera_pose': False}, 'EVAL_VECTORIZED': {'simulator_gpu_ids': 1, 'split': 'val', 'num_episodes_per_env': 10, 'record_videos': 1, 'record_planner_videos': 0, 'metrics_save_freq': 5}, 'AGENT': {'max_steps': 10000, 'panorama_start': 1, 'exploration_strategy': 'seen_frontier', 'radius': 0.05, 'fall_wait_steps': 0, 'clip_embeddings_file': 'data/objects/clip_embeddings.pickle', 'detection_module': 'grounded_sam', 'detection_module_kwargs': {'box_threshold': 0.5, 'text_threshold': 0.5, 'nms_threshold': 0.8}, 'SEMANTIC_MAP': {'semantic_categories': 'rearrange', 'num_sem_categories': 5, 'map_size_cm': 4800, 'map_resolution': 5, 'vision_range': 100, 'global_downscaling': 2, 'du_scale': 4, 'cat_pred_threshold': 1.0, 'exp_pred_threshold': 1.0, 'map_pred_threshold': 100.0, 'been_close_to_radius': 100, 'explored_radius': 50, 'must_explore_close': False, 'min_obs_height_cm': 10, 'dilate_obstacles': True, 'dilate_size': 3, 'dilate_iter': 1}, 'SKILLS': {'GAZE_OBJ': {'type': 'rl', 'checkpoint_path': 'data/checkpoints/ovmm_baseline_home_robot_challenge_2023_v0.2/gaze_at_obj.pth', 'rl_config': 'projects/habitat_ovmm/configs/agent/gaze_rl.yaml', 'gym_obs_keys': ['robot_head_depth', 'object_embedding', 'object_segmentation', 'joint', 'is_holding', 'relative_resting_position'], 'allowed_actions': ['arm_action', 'base_velocity'], 'arm_joint_mask': [0, 0, 0, 0, 0, 0, 1], 'max_displacement': 0.25, 'max_turn_degrees': 30.0, 'min_turn_degrees': 5.0, 'min_displacement': 0.1, 'sensor_height': 160, 'sensor_width': 120, 'nav_goal_seg_channels': 1, 'terminate_condition': 'grip', 'grip_threshold': 0.8, 'max_joint_delta': 0.1, 'min_joint_delta': 0.02}, 'PICK': {'type': 'hw'}, 'NAV_TO_OBJ': {'type': 'heuristic', 'checkpoint_path': 'data/checkpoints/ovmm_baseline_home_robot_challenge_2023_v0.2/nav_to_obj.pth', 'rl_config': 'projects/habitat_ovmm/configs/agent/nav_to_obj_rl.yaml', 'gym_obs_keys': ['robot_head_depth', 'object_embedding', 'ovmm_nav_goal_segmentation', 'receptacle_segmentation', 'start_receptacle', 'robot_start_gps', 'robot_start_compass', 'joint'], 'allowed_actions': ['stop', 'move_forward', 'turn_left', 'turn_right'], 'arm_joint_mask': [0, 0, 0, 0, 0, 0, 0], 'max_displacement': 0.25, 'max_turn_degrees': 30.0, 'min_turn_degrees': 5.0, 'min_displacement': 0.1, 'sensor_height': 160, 'sensor_width': 120, 'terminate_condition': 'discrete_stop', 'nav_goal_seg_channels': 2}, 'NAV_TO_REC': {'type': 'heuristic', 'checkpoint_path': 'data/checkpoints/ovmm_baseline_home_robot_challenge_2023_v0.2/nav_to_rec.pth', 'rl_config': 'projects/habitat_ovmm/configs/agent/nav_to_obj_rl.yaml', 'gym_obs_keys': ['robot_head_depth', 'ovmm_nav_goal_segmentation', 'receptacle_segmentation', 'goal_receptacle', 'robot_start_gps', 'robot_start_compass', 'joint'], 'allowed_actions': ['stop', 'move_forward', 'turn_left', 'turn_right'], 'arm_joint_mask': [0, 0, 0, 0, 0, 0, 0], 'max_displacement': 0.25, 'max_turn_degrees': 30.0, 'min_turn_degrees': 5.0, 'min_displacement': 0.1, 'sensor_height': 160, 'sensor_width': 120, 'terminate_condition': 'discrete_stop', 'nav_goal_seg_channels': 1}, 'PLACE': {'type': 'heuristic', 'checkpoint_path': 'data/checkpoints/ovmm_baseline_home_robot_challenge_2023_v0.2/place.pth', 'rl_config': 'projects/habitat_ovmm/configs/agent/place_rl.yaml', 'gym_obs_keys': ['robot_head_depth', 'goal_receptacle', 'joint', 'goal_recep_segmentation', 'is_holding', 'object_embedding'], 'allowed_actions': ['arm_action', 'base_velocity', 'manipulation_mode'], 'arm_joint_mask': [1, 1, 1, 1, 1, 0, 0], 'max_displacement': 0.25, 'max_turn_degrees': 30.0, 'min_turn_degrees': 5.0, 'min_displacement': 0.1, 'sensor_height': 160, 'sensor_width': 120, 'nav_goal_seg_channels': 1, 'terminate_condition': 'ungrip', 'grip_threshold': -0.8, 'manip_mode_threshold': 0.8, 'constraint_base_in_manip_mode': True, 'max_joint_delta': 0.1, 'min_joint_delta': 0.02}}, 'skip_skills': {'nav_to_obj': False, 'nav_to_rec': False, 'gaze_at_obj': True, 'gaze_at_rec': True, 'pick': False, 'place': False}, 'PLANNER': {'collision_threshold': 0.2, 'obs_dilation_selem_radius': 5, 'goal_dilation_selem_radius': 10, 'step_size': 5, 'use_dilation_for_stg': False, 'min_obs_dilation_selem_radius': 3, 'map_downsample_factor': 1, 'map_update_frequency': 1, 'discrete_actions': False, 'verbose': True}}}
Traceback (most recent call last):